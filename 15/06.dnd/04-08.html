<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=gbk">
        <title>06.dnd</title>
        <link rel="stylesheet" type="text/css" href="../../resources/css/ext-all.css" />
        <script type="text/javascript" src="../../adapter/ext/ext-base.js"></script>
        <script type="text/javascript" src="../../ext-all.js"></script>
        <style type="text/css">

.dd-demo {
    position: relative;
    text-align: center;
    color: #fff;
    cursor: move;
    height: 60px;
    width: 60px;
    padding: 0;
    margin: 0;
}

.dd-demo div {
    border: 1px solid black;
    height: 58px;
    width: 58px;
}

#dd-demo-canvas1 {
    padding: 55px;
    background-color: #7E5B60;
    border: 1px solid black;
}
#dd-demo-canvas2 {
    padding: 25px;
    background-color: #566F4E;
    border: 1px solid black;
}
#dd-demo-canvas3 {
    padding: 15px;
    background-color: #6D739A;
    border: 1px solid black;
}

#dd-demo-1 {
    background-color:#6D739A;top:5px; left:5px;
}

#dd-demo-2 {
    background-color:#566F4E;top:50px; left:100px;
}

#dd-demo-3 {
    background-color:#7E5B60;top:-100px; left:200px;
}

        </style>
        <script type="text/javascript">
Ext.ux.DDRegion = function(id, sGroup, config) {
    this.cont = config.cont;
    Ext.ux.DDRegion.superclass.constructor.apply(this, arguments);
};

Ext.extend(Ext.ux.DDRegion, Ext.dd.DD, {
    cont: null,
    init: function() {
        Ext.ux.DDRegion.superclass.init.apply(this, arguments);
        this.initConstraints();
    },
    initConstraints: function() {
        var region = Ext.get(this.cont).getRegion();

        var el = this.getEl();
        var xy = Ext.get(el).getXY();

        var width = parseInt(Ext.get(el).getStyle('width'), 10);
        var height = parseInt(Ext.get(el).getStyle('height'), 10);

        var left = xy[0] - region.left;
        var right = region.right - xy[0] - width;

        var top = xy[1] - region.top;
        var bottom = region.bottom - xy[1] - height;

        this.setXConstraint(left, right);
        this.setYConstraint(top, bottom);
    }
});

Ext.onReady(function(){
    dd1 = new Ext.ux.DDRegion('dd-demo-1', '', { cont: 'dd-demo-canvas3' });
    dd2 = new Ext.ux.DDRegion('dd-demo-2', '', { cont: 'dd-demo-canvas2' });
    dd3 = new Ext.ux.DDRegion('dd-demo-3', '', { cont: 'dd-demo-canvas1' });
});
        </script>
    </head>
    <body>
        <script type="text/javascript" src="../shared/examples.js"></script>
        <h1>Drag and Drop Region</h1>
        <div id="dd-demo-canvas1">
            <div id="dd-demo-canvas2">
                <div id="dd-demo-canvas3">
                    <div id="dd-demo-1" class="dd-demo"><div>1</div></div>
                    <div id="dd-demo-2" class="dd-demo"><div>2</div></div>
                    <div id="dd-demo-3" class="dd-demo"><div>3</div></div>
                </div>
            </div>
        </div>
    </body>
</html>
